var ruby = require('ruby');

var $ = ruby.__proto__;

$.protect_node = function(code) {
  return function() {
    var args = arguments;
    return ruby.protect(function() {
      return code.apply(this, args);
    }, function(e) {
      console.log("Exception in Ruby code: " + this.funcall(e, 'to_s'));
    });
  };
}
